<html> <head> <meta http-equiv="Content-Type" content="text/html; charset='utf-8'" /> <meta name="keywords" content="restas,web,framework,web framework,REST,Common Lisp,lisp" /> <title>SLIME</title> <link rel="stylesheet" type="text/css" href="../_static/style.css" /> </head> <body> <a href="http://github.com/archimag/restas/"> <img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub"> </a> <div id="frame"> <div id="page-title"> <h1>RESTAS</h1> <b>Фрэймворк для разработки web-приложений на Common Lisp</b> </div> <div id="menu"> <ul> <li> <a href="../index.html">Начало</a>  </li><li> <a href="../overview.html">Обзор</a>  </li><li> <a href="../installation.html">Установка</a>  </li><li> <a href="../tutorial/contents.html">Введение</a> <ul> <li> <a href="../tutorial/hello-world.html">Hello World</a> </li><li> <a href="../tutorial/pastebin.html">Pastebin</a> </li> </ul> </li><li> <a href="contents.html">Руководство</a> <ul> <li> <a href="routes.html">Маршруты</a> </li><li> <a href="modules.html">Модули</a> </li><li> <a href="view.html">Представление</a> </li><li> <a href="special-pages.html">Специальные страницы</a> </li><li> <a href="decorators.html">Декораторы</a> </li><li> <a href="daemon.html">Демонизация</a> </li><li> <strong>SLIME</strong> </li> </ul> </li><li> <a href="../ref/index.html">API Reference</a>  </li> </ul> </div> <div id="content"> <div id="slime" class="document"><h1>SLIME<a href="#slime" class="headerlink" title="Permalink to this headline">¶</a></h1><h2 id="m-c-x-vs-c-c-c-c">M-C-x vs C-c C-c<a href="#m-c-x-vs-c-c-c-c" class="headerlink" title="Permalink to this headline">¶</a></h2><a id="manual-slime" class="target" name="manual-slime"></a><p>Одной из самых сильных сторон Common Lisp является мощная поддержка интерактивной разработки. <a class="reference" href="http://restas.lisper.ru/"><span>RESTAS</span></a> стремится предоставить соответствующие возможности в области разработки веб-приложений. Эта возможность обеспечивается за счёт функции <a class="common-lisp-entity" href="../ref/index.html#restas-reconnect-all-routes">restas:reconnect-all-routes</a>, которая пере-инициализирует диспетчер запросов. Определения субмодулей (<a class="common-lisp-entity" href="../ref/index.html#restas-mount-submodule">restas:mount-submodule</a>) и маршрутов (<a class="common-lisp-entity" href="../ref/index.html#restas-define-route">restas:define-route</a>) могут быть в любой момент "перевычисленны" и внесённые изменения немедленно отражаться на работе активных restas-приложений.  Данные макросы, в том числе, содержат примерно такой код:</p>
<p><div class="code"><span class="paren1">(<span class=""><i><span class="symbol">eval-when</span></i> <span class="paren2">(<span class=""><span class="keyword">:execute</span></span>)</span><br>&nbsp;&nbsp;<span class="paren2">(<span class="">reconnect-all-routes</span>)</span></span>)</span></div></p>
<p>Т.е. для того, что бы внесённые изменения вступили в силу данные макросы должны быть выполнены, а не просто загружены или скомпилированы. При использовании <a class="reference" href="http://common-lisp.net/project/slime/"><span>SLIME</span></a> это достигается за счёт использования команды C-M-x (slime-eval-defun), вместо более обычной С-с С-с (slime-compile-defun). Однако, если изменилось только тело маршрута (определённого с помощью <a class="common-lisp-entity" href="../ref/index.html#restas-define-route">restas:define-route</a>), то для активизации изменений достаточно и просто скомпилировать C-c C-c, мало того, именно так и рекомендуется делать, поскольку компиляция, в отличие от выполнения, позволяет сохранить информацию о расположении маршрута в исходном коде (технически это связано с тем, что определение маршрута также создаёт одноимённую функцию) - это может оказаться очень полезным при работе с картой сайта (см. далее).</p>
<div id="slime-archimag" class="section"><h2>SLIME-ARCHIMAG<a href="#slime-archimag" class="headerlink" title="Permalink to this headline">¶</a></h2><p>При использовании <a class="reference" href="http://github.com/archimag/slime-archimag"><span>SLIME-ARCHIMAG</span></a> в Emacs становятся доступны команды <em><span>M-x restas-inspect-module</span></em> и <em><span>M-x restas-inspect-vhost-list</span></em>, реализованные на основе стандартного SLIME INSPECTOR (инспектора объектов).</p>
<div id="инспектор-модулей" class="section"><h3>Инспектор модулей<a href="#инспектор-модулей" class="headerlink" title="Permalink to this headline">¶</a></h3><p>Активизируется вызовом <em><span>M-x restas-inspect-module</span></em>, при этом надо указать имя модуля (имя соответствующего пакета).</p>
<div class="image"><img src="../_static/module-inspector.png" alt="module inspector" /></div>
<p>В появившемся инспекторе показываются:</p>
<ul>
<li><p class="first">Функции инициализации и финализации модуля. Открыть определение этих функций можно установив курсор на показанную функцию и нажав "." (команда slime-inspector-show-source) - это стандартная возможность <a class="reference" href="http://common-lisp.net/project/slime/"><span>SLIME</span></a>.</p>
</li>
<li><p class="first">Список маршрутов, определяемых модулем. Enter или Space откроет более подробную информацию о маршруте. А "." покажет определение его в исходном коде.</p>
</li>
<li><p class="first">Список субмодулей модуля. Enter или Space откроет инспектор субмодлуей.</p>
</li>
</ul>
</div>
<div id="инспектор-хостов" class="section"><h3>Инспектор хостов<a href="#инспектор-хостов" class="headerlink" title="Permalink to this headline">¶</a></h3><p>Команда <em><span>M-x restas-inspect-vhost-list</span></em> показывает список активных virtual hosts.</p>
<div class="image"><img src="../_static/vhosts-inspector.png" alt="vhosts inspector" /></div>
<p>После выбора нужного vhost открывается доступ к "карте сайта" и списку субмодулей, которые присоединяются к vhost во время запуска сайта функцией <a class="common-lisp-entity" href="../ref/index.html#restas-start">restas:start</a>.</p>
<div class="image"><img src="../_static/vhost-inspector.png" alt="vhosts inspector" /></div>
</div>
<div id="карта-сайта" class="section"><h3>Карта сайта<a href="#карта-сайта" class="headerlink" title="Permalink to this headline">¶</a></h3><div class="image"><img src="../_static/site-map-inspector.png" alt="site map inspector" /></div>
<p>Инспектор карты сайта позволяет наглядно рассмотреть дерево маршрутов. Переменные шаблонов подсвечиваются и показываются с префиксами $ и * (для wilcard переменных). Каждую переменную также можно исследовать, например, что бы увидеть с помощью какой функции производиться парсинг переменной. В конце каждого листа этого дерева находиться объект-маршрут, нажав на нём "." можно перейти к месту определения маршрута, а Enter позволит исследовать его более детально (какой HTTP-метод обрабатывает, какие для него проводятся дополнительные проверки и т.п.). Таким образом, данный функционал позволяет исследовать и лучше понять как именно идёт обработка запроса и также может использоваться для простой, ориентированной на специфику веб-приложений, навигации по коду.</p>
</div>
<div id="инспектор-субмодулей" class="section"><h3>Инспектор субмодулей<a href="#инспектор-субмодулей" class="headerlink" title="Permalink to this headline">¶</a></h3><div class="image"><img src="../_static/submodule-inspector.png" alt="submodule inspector" /></div>
<p>Инспектор субмодулей похож на инспектор модулей, но также содержит раздел Context, в котором перечисляются переменные, связанные при подключении модуля с помощью <a class="common-lisp-entity" href="../ref/index.html#restas-mount-submodule">restas:mount-submodule</a></p>
<div class="image"><img src="../_static/planet-submodule-inspector.png" alt="planet submodule inspector" /></div>
<p>Команда <strong><span>"Use this context as global"</span></strong> делает его глобальным (путем непосредственного присваивания соответствующим переменным значений) - это может оказаться очень удобным для отладки приложения  в REPL. После чего можно будет вернуть изначальное состояние командой <strong><span>"Restore global context"</span></strong>.</p>
</div>
</div>
</div> </div> </div> <div class="bottom">@2009-2011 <a href="mailto:archimag@gmail.com">Moskvitin Andrey</a></div> </body> </html>