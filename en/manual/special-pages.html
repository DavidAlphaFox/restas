<html> <head> <meta http-equiv="Content-Type" content="text/html; charset='utf-8'" /> <meta name="keywords" content="restas,web,framework,web framework,REST,Common Lisp,lisp" /> <title>Special pages</title> <link rel="stylesheet" type="text/css" href="../_static/style.css" /> </head> <body> <a href="http://github.com/archimag/restas/"> <img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub"> </a> <div id="frame"> <div id="page-title"> <h1>RESTAS</h1> <b>Framework for web application development in Common Lisp</b> </div> <div id="menu"> <ul> <li> <a href="../index.html">Home</a>  </li><li> <a href="../overview.html">Overview</a>  </li><li> <a href="../installation.html">Installation</a>  </li><li> <a href="../tutorial/contents.html">Tutorials</a> <ul> <li> <a href="../tutorial/hello-world.html">Hello World</a> </li><li> <a href="../tutorial/pastebin.html">Pastebin</a> </li> </ul> </li><li> <a href="contents.html">Manual</a> <ul> <li> <a href="routes.html">Routes</a> </li><li> <a href="modules.html">Modules</a> </li><li> <a href="view.html">View</a> </li><li> <strong>Special pages</strong> </li><li> <a href="decorators.html">Decorators</a> </li><li> <a href="daemon.html">Daemonization</a> </li><li> <a href="slime.html">SLIME</a> </li> </ul> </li><li> <a href="../ref/index.html">API Reference</a>  </li> </ul> </div> <div id="content"> <div id="special-pages" class="document"><h1>Special pages<a href="#special-pages" class="headerlink" title="Permalink to this headline">Â¶</a></h1><!-- -*- RST -*- -->
<a id="manual-special-pages" class="target" name="manual-special-pages"></a><p>If the route handler returns an integer, the return value is interpreted as an HTTP status code, and the corresponding response page (ex - 404 not found) is sent to the user. By default the pages returned are the <a class="reference" href="http://www.weitz.de/hunchentoot/"><span>Hunchentoot</span></a> standard ones. This behavior can be changed by defining a method on the <a class="common-lisp-entity" href="../ref/index.html#restas-render-object">restas:render-object</a> generic function. For example:</p>
<p><div class="code"><span class="paren1">(<span class=""><i><span class="symbol">defmethod</span></i> restas:render-object <span class="paren2">(<span class=""><span class="paren3">(<span class="">designer mydrawer</span>)</span> <span class="paren3">(<span class="">code <span class="paren4">(<span class="">eql hunchentoot:+http-internal-server-error+</span>)</span></span>)</span></span>)</span><br>&nbsp;&nbsp;<span class="paren2">(<span class="">setf <span class="paren3">(<span class="">hunchentoot:content-type*</span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"text/plain"</span></span>)</span><br>&nbsp;&nbsp;<span class="string">"Oh, all very bad"</span></span>)</span></div></p>
<p>In this case, it may happen that if the handler of route returns <span class="common-lisp-entity">hunchentoot:+http-not-found+</span> then the client will receive a customized "Not Found" message, but if RESTAS does not find a suitable route, then it sends the standard <a class="reference" href="http://www.weitz.de/hunchentoot/"><span>Hunchentoot</span></a> 404 page. To solve this problem you can define a "universal" route, which will be checked last after all other routes.</p>
<p><div class="code"><span class="paren1">(<span class=""><i><span class="symbol">restas:define-route</span></i> not-found <span class="paren2">(<span class=""><span class="string">"*any"</span></span>)</span><br>&nbsp;&nbsp;hunchentoot:+http-not-found+</span>)</span></div></p>
<p>The described approach is well suited for handling specific pages on a module level. But sometimes you need a particular solution. For example, the Web server can interact with AJAX code, and in case of error should return <span class="common-lisp-entity">hunchentoot:+http-internal-server-error+</span>, describing the type of error in the response body. <a class="common-lisp-entity" href="../ref/index.html#restas-abort-route-handler">restas:abort-route-handler</a> can be used to implement this. For example</p>
<p><div class="code"><span class="paren1">(<span class="">restas:abort-route-handler <span class="string">"data invalid"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">:return-code</span> hunchentoot:+http-internal-server-error+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">:content-type</span> <span class="string">"text/plain"</span></span>)</span></div></p>
<p>sends a response with HTTP status 500 and message "data invalid" to the client.</p>
</div> </div> </div> <div class="bottom">@2009-2011 <a href="mailto:archimag@gmail.com">Moskvitin Andrey</a></div> </body> </html>