<html> <head> <meta http-equiv="Content-Type" content="text/html; charset='utf-8'" /> <meta name="keywords" content="restas,web,framework,web framework,REST,Common Lisp,lisp" /> <title>Hello World</title> <link rel="stylesheet" type="text/css" href="../static/style.css" /> </head> <body> <a href="http://github.com/archimag/restas/"> <img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub"> </a> <div id="frame"> <div id="page-title"> <h1>RESTAS</h1> <b>Framework for web application development in Common Lisp</b> </div> <div id="menu"> <ul> <li> <a href="../index.html">Home</a>  </li><li> <a href="../overview.html">Overview</a>  </li><li> <a href="../installation.html">Installation</a>  </li><li> <a href="contents.html">Tutorials</a> <ul> <li> <strong>Hello World</strong> </li><li> <a href="pastebin.html">Pastebin</a> </li> </ul> </li><li> <a href="../manual/contents.html">Manual</a> <ul> <li> <a href="../manual/routes.html">Routes</a> </li><li> <a href="../manual/modules.html">Modules</a> </li><li> <a href="../manual/view.html">View</a> </li><li> <a href="../manual/special-pages.html">Special pages</a> </li><li> <a href="../manual/decorators.html">Decorators</a> </li><li> <a href="../manual/daemon.html">Daemonization</a> </li><li> <a href="../manual/slime.html">SLIME</a> </li> </ul> </li><li> <a href="../ref/index.html">API Reference</a>  </li> </ul> </div> <div id="content"> <div id="hello-world" class="document"><h1>Hello World<a href="#hello-world" class="headerlink" title="Permalink to this headline">¶</a></h1><h2 id="a-simple-example">A simple example<a href="#a-simple-example" class="headerlink" title="Permalink to this headline">¶</a></h2><!-- -*- RST -*- -->
<a id="tutorial-hello-world" class="target" name="tutorial-hello-world"></a><p>Here is a classic "Hello world":</p>
<p><div class="code"><span class="paren1">(<span class="">asdf:operate 'asdf:load-op '<span class="keyword">#:restas</span></span>)</span><br><br>
<span class="paren1">(<span class=""><i><span class="symbol">restas:define-module</span></i> <span class="keyword">#:restas.hello-world</span><br>&nbsp;&nbsp;<span class="paren2">(<span class=""><span class="keyword">:use</span> <span class="keyword">:cl</span></span>)</span></span>)</span><br><br>
<span class="paren1">(<span class=""><a href="http://www.lispworks.com/reference/HyperSpec/Body/m_in_pkg.htm" class="symbol">in-package</a> <span class="keyword">#:restas.hello-world</span></span>)</span><br><br>
<span class="paren1">(<span class=""><i><span class="symbol">restas:define-route</span></i> main <span class="paren2">(<span class=""><span class="string">""</span></span>)</span><br>&nbsp;&nbsp;<span class="string">"&lt;h1&gt;Hello world!&lt;/h1&gt;"</span></span>)</span><br><br>
<span class="paren1">(<span class="">restas:start '<span class="keyword">#:restas.hello-world</span> <span class="keyword">:port</span> 8080</span>)</span></div></p>
<p>If you execute this code and open <a class="reference" href="http://localhost:8080/"><span>http://localhost:8080/</span></a> in your browser, you will see "Hello world" heading. That's nice. :)</p>
<p>Now, one after another, line by line:</p>
<p>To begin with, lets load <a class="reference" href="http://restas.lisper.ru/"><span>RESTAS</span></a> itself:</p>
<p><div class="code"><span class="paren1">(<span class="">asdf:operate 'asdf:load-op '<span class="keyword">#:restas</span></span>)</span></div></p>
<p>Then we define a new module:</p>
<p><div class="code"><span class="paren1">(<span class=""><i><span class="symbol">restas:define-module</span></i> <span class="keyword">#:restas.hello-world</span><br>&nbsp;&nbsp;<span class="paren2">(<span class=""><span class="keyword">:use</span> <span class="keyword">:cl</span></span>)</span></span>)</span></div></p>
<p>Actually, this code only creates a <a href="http://www.lispworks.com/reference/HyperSpec/Body/t_pkg.htm" class="common-lisp-entity">package</a> and initializes it, adding several variables to it. A module is not an object or a symbol, but is associated with a package. Why is it done in a such way? Using a package as a module lets us, in most cases, not to specify the module explicitly, but just to place the module's code into the package associated with it.</p>
<p>Now we change current package.</p>
<p><div class="code"><span class="paren1">(<span class=""><a href="http://www.lispworks.com/reference/HyperSpec/Body/m_in_pkg.htm" class="symbol">in-package</a> <span class="keyword">#:restas.hello-world</span></span>)</span></div></p>
<p>Then we create a route for processing GET requests to the site root.</p>
<p><div class="code"><span class="paren1">(<span class=""><i><span class="symbol">restas:define-route</span></i> main <span class="paren2">(<span class=""><span class="string">""</span></span>)</span><br>&nbsp;&nbsp;<span class="string">"&lt;h1&gt;Hello world!&lt;/h1&gt;"</span></span>)</span></div></p>
<p>Inside ot the macro <a class="common-lisp-entity" href="../ref/index.html#restas-define-route">restas:define-route</a> you can place any code, which must return a string, or an octets <a href="http://www.lispworks.com/reference/HyperSpec/Body/t_array.htm" class="common-lisp-entity">array</a>, or a <a href="http://www.lispworks.com/reference/HyperSpec/Body/a_pn.htm" class="common-lisp-entity">pathname</a> (in this case client will get according file), or an integer number (which is interpreted as request status, for example, <span class="common-lisp-entity">hunchentoot:+http-not-found++</span>). Also, this code can freely use any variables, noted in the <a class="reference" href="http://www.weitz.de/hunchentoot/"><span>Hunchentoot</span></a> web server's documentation (e.g. <span class="common-lisp-entity">hunchentoot:*request*</span> or <span class="common-lisp-entity">hunchentoot:*reply*</span>).</p>
<p>Lets launch the web server and activate the site:</p>
<p><div class="code"><span class="paren1">(<span class="">restas:start '<span class="keyword">#:restas.hello-world</span> <span class="keyword">:port</span> 8080</span>)</span></div></p>
<div id="processing-of-post-requests" class="section"><h2>Processing of POST requests.<a href="#processing-of-post-requests" class="headerlink" title="Permalink to this headline">¶</a></h2><p>This example shows different treatment of GET and POST requests:</p>
<p><div class="code"><span class="paren1">(<span class="">asdf:operate 'asdf:load-op <span class="keyword">:cl-who</span></span>)</span><br>
<span class="paren1">(<span class="">asdf:operate 'asdf:load-op <span class="keyword">:restas</span></span>)</span><br>
<br>
<span class="paren1">(<span class=""><i><span class="symbol">restas:define-module</span></i> <span class="keyword">:restas.example-1</span><br>&nbsp;&nbsp;<span class="paren2">(<span class=""><span class="keyword">:use</span> <span class="keyword">:cl</span></span>)</span></span>)</span><br>
<br>
<span class="paren1">(<span class=""><a href="http://www.lispworks.com/reference/HyperSpec/Body/m_in_pkg.htm" class="symbol">in-package</a> <span class="keyword">:restas.example-1</span></span>)</span><br>
<br>
<span class="paren1">(<span class=""><i><span class="symbol">restas:define-route</span></i> main <span class="paren2">(<span class=""><span class="string">""</span> <span class="keyword">:method</span> <span class="keyword">:get</span></span>)</span><br>&nbsp;&nbsp;<span class="paren2">(<span class=""><i><span class="symbol">who:with-html-output-to-string</span></i> <span class="paren3">(<span class="">out</span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren3">(<span class=""><span class="keyword">:html</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren4">(<span class=""><span class="keyword">:body</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="paren6">(<span class=""><span class="keyword">:form</span> <span class="keyword">:method</span> <span class="keyword">:post</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren6">(<span class=""><span class="paren1">(<span class=""><span class="keyword">:input</span> <span class="keyword">:name</span> <span class="string">"message"</span></span>)</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren6">(<span class=""><span class="paren1">(<span class=""><span class="keyword">:input</span> <span class="keyword">:type</span> <span class="string">"submit"</span> <span class="keyword">:value</span> <span class="string">"Send"</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span><br>
<br>
<span class="paren1">(<span class=""><i><span class="symbol">restas:define-route</span></i> main/post <span class="paren2">(<span class=""><span class="string">""</span> <span class="keyword">:method</span> <span class="keyword">:post</span></span>)</span><br>&nbsp;&nbsp;<span class="paren2">(<span class=""><i><span class="symbol">who:with-html-output-to-string</span></i> <span class="paren3">(<span class="">out</span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren3">(<span class=""><span class="keyword">:html</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren4">(<span class=""><span class="keyword">:body</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="keyword">:div</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren6">(<span class=""><span class="keyword">:b</span> <span class="paren1">(<span class="">who:fmt <span class="string">"test message: ~A"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren2">(<span class="">hunchentoot:post-parameter <span class="string">"message"</span></span>)</span></span>)</span></span>)</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="paren6">(<span class=""><span class="keyword">:a</span> <span class="keyword">:href</span> <span class="paren1">(<span class="">restas:genurl 'main</span>)</span></span>)</span> <span class="string">"Try again"</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span><br>
<br>
<span class="paren1">(<span class="">restas:start '<span class="keyword">#:restas.example-1</span> <span class="keyword">:port</span> 8080</span>)</span></div></p>
<p>When you execute it and open the page <a class="reference" href="http://localhost:8080/"><span>http://localhost:8080/</span></a>, you will see an elementary form, in which you are offered to type an arbitrary message. After that you can Send it and get a new page, containing a typed message and a link with an offer to repeat your input. Just a little bit to improve and you can start selling it. :)</p>
<p>This example is different from previous in that it now contains two routes, one for processing GET requests and the other one for POST ones. As you see, you can specify the type of request the route concerns, with key :method, which is :get by default. Presence of "post" ending in 'main/post route name is just a coincidence: routes can be named in an arbitrary way, as long as each route has a unique name.</p>
</div>
<div id="parameterized-routes" class="section"><h2>Parameterized routes<a href="#parameterized-routes" class="headerlink" title="Permalink to this headline">¶</a></h2><p>The URL template specified in <a class="common-lisp-entity" href="../ref/index.html#restas-define-route">restas:define-route</a> isn't required to be as simple as in previous examples. It can contain several parameters available for the handler and specified inside of <a class="common-lisp-entity" href="../ref/index.html#restas-define-route">restas:define-route</a>.</p>
<p><div class="code"><span class="paren1">(<span class="">asdf:operate 'asdf:load-op <span class="keyword">:cl-who</span></span>)</span><br>
<span class="paren1">(<span class="">asdf:operate 'asdf:load-op <span class="keyword">:restas</span></span>)</span><br>
<br>
<span class="paren1">(<span class=""><i><span class="symbol">restas:define-module</span></i> <span class="keyword">:restas.example-2</span><br>&nbsp;&nbsp;<span class="paren2">(<span class=""><span class="keyword">:use</span> <span class="keyword">:cl</span> <span class="keyword">:iter</span></span>)</span></span>)</span><br>
<br>
<span class="paren1">(<span class=""><a href="http://www.lispworks.com/reference/HyperSpec/Body/m_in_pkg.htm" class="symbol">in-package</a> <span class="keyword">:restas.example-2</span></span>)</span><br>
<br>
<span class="paren1">(<span class=""><i><span class="symbol">restas:define-route</span></i> root <span class="paren2">(<span class=""><span class="string">""</span></span>)</span><br>&nbsp;&nbsp;<span class="paren2">(<span class=""><i><span class="symbol">who:with-html-output-to-string</span></i> <span class="paren3">(<span class="">out</span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren3">(<span class=""><span class="keyword">:html</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren4">(<span class=""><span class="keyword">:head</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="keyword">:title</span> <span class="string">"Example 2: Index"</span></span>)</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren4">(<span class=""><span class="keyword">:body</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="keyword">:h1</span> <span class="string">"Index"</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="keyword">:ul</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren6">(<span class="">iter <span class="paren1">(<span class="">for x from 1 to 10</span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren1">(<span class="">who:htm <span class="paren2">(<span class=""><span class="keyword">:li</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren3">(<span class=""><span class="paren4">(<span class=""><span class="keyword">:a</span> <span class="keyword">:href</span> <span class="paren5">(<span class="">restas:genurl 'chapter-?.html <span class="keyword">:id</span> x</span>)</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren4">(<span class="">who:fmt <span class="string">"Chapter ~A"</span> x</span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span><br>
<br>
<span class="paren1">(<span class=""><i><span class="symbol">restas:define-route</span></i> chapter-?.html <span class="paren2">(<span class=""><span class="string">"chapter-:(id).html"</span></span>)</span><br>&nbsp;&nbsp;<span class="paren2">(<span class=""><i><span class="symbol">who:with-html-output-to-string</span></i> <span class="paren3">(<span class="">out</span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren3">(<span class=""><span class="keyword">:html</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren4">(<span class=""><span class="keyword">:head</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="keyword">:title</span> <span class="paren6">(<span class="">who:fmt <span class="string">"Example 2. Chapter ~A"</span> id</span>)</span></span>)</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren4">(<span class=""><span class="keyword">:body</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="keyword">:h1</span> <span class="paren6">(<span class="">who:fmt <span class="string">"Chapter ~A"</span> id</span>)</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="keyword">:ul</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren6">(<span class="">iter <span class="paren1">(<span class="">for x from 1 to 10</span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren1">(<span class="">who:htm <span class="paren2">(<span class=""><span class="keyword">:li</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren3">(<span class=""><span class="paren4">(<span class=""><span class="keyword">:a</span> <span class="keyword">:href</span> <span class="paren5">(<span class="">restas:genurl 'chapter-?-?.html <span class="keyword">:id1</span> id <span class="keyword">:id2</span> x</span>)</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren4">(<span class="">who:fmt <span class="string">"Chapter ~A-~A"</span> id x</span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="paren6">(<span class=""><span class="keyword">:a</span> <span class="keyword">:href</span> <span class="paren1">(<span class="">restas:genurl 'root</span>)</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"Back to Index"</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span><br>
<br>
<span class="paren1">(<span class=""><i><span class="symbol">restas:define-route</span></i> chapter-?-?.html <span class="paren2">(<span class=""><span class="string">"chapter-:(id1)-:(id2).html"</span></span>)</span><br>&nbsp;&nbsp;<span class="paren2">(<span class=""><i><span class="symbol">who:with-html-output-to-string</span></i> <span class="paren3">(<span class="">out</span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren3">(<span class=""><span class="keyword">:html</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren4">(<span class=""><span class="keyword">:head</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="keyword">:title</span> <span class="paren6">(<span class="">who:fmt <span class="string">"Example 2. Chapter ~A-~A"</span> id1 id2</span>)</span></span>)</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren4">(<span class=""><span class="keyword">:body</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="keyword">:h1</span> <span class="paren6">(<span class="">who:fmt <span class="string">"Chapter ~A-~A"</span> id1 id2</span>)</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="keyword">:p</span> <span class="paren6">(<span class="">who:fmt <span class="string">"This is a chapter ~A-~A"</span> id1 id2</span>)</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren5">(<span class=""><span class="paren6">(<span class=""><span class="keyword">:a</span> <span class="keyword">:href</span> <span class="paren1">(<span class="">restas:genurl 'chapter-?.html <span class="keyword">:id</span> id1</span>)</span></span>)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="paren6">(<span class="">who:fmt <span class="string">"Back to Chapter ~A"</span> id1</span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span><br>
<br>
<span class="paren1">(<span class="">restas:start <span class="keyword">:restas.example-2</span> <span class="keyword">:port</span> 8080</span>)</span></div></p>
<p>This example demonstrates navigation in some "Book with table of contents", parametrized routes, and generation of links from names of routes.</p>
<p>The code of the above examples comes with <a class="reference" href="http://restas.lisper.ru/"><span>RESTAS</span></a> in the 'example' directory.</p>
</div>
</div> </div> </div> <div class="bottom">@2009-2011 <a href="mailto:archimag@gmail.com">Moskvitin Andrey</a></div> </body> </html>